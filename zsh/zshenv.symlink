# Executed by non-interactive shells like Ampcode

HERMIT_ROOT_BIN="${HERMIT_ROOT_BIN:-"$HOME/bin/hermit"}"

if [[ -x "$HERMIT_ROOT_BIN" ]]; then
  eval "$($HERMIT_ROOT_BIN shell-hooks --print --zsh)"

  # Auto-activate hermit directly by checking for bin/activate-hermit
  CUR=${PWD}
  while [[ "$CUR" != "/" ]]; do
    if [[ -f "${CUR}/bin/activate-hermit" ]]; then
      eval "$($HERMIT_ROOT_BIN activate "${CUR}" 2>/dev/null)"
      break
    fi
    CUR="$(dirname "${CUR}")"
  done
fi
